{
	"AWSTemplateFormatVersion": "2010-09-09",
	"Description": "Defines the target groups used by the static network load balancers to direct traffic to the dynamic stack application load balancers",
	"Resources": {
	#foreach( $port in $albTargetPorts )
		#if($foreach.count > 1)
		,
		#end
		"${stack}${instance}albtarget${port}": {
			"Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
			"Properties": {
				"HealthCheckEnabled": true,
				"HealthCheckIntervalSeconds": 30,
				"HealthCheckPath": "/",
				"HealthCheckPort": 443,
				"HealthCheckProtocol": "HTTPS",
				"HealthCheckTimeoutSeconds": 10,
				"HealthyThresholdCount": 2,
				"IpAddressType": "ipv4",
				"Matcher": {
					"HttpCode": "200-599"
				},
				"Name": "${stack}${instance}albtarget${port}",
				"Port": ${port},
				"Protocol": "TCP",
				"Targets": [
					{
						"Id": {"Ref" : "AWSEBV2LoadBalancer" }
						"Port": ${port}
					}
				],
				"TargetType": "alb",
				"UnhealthyThresholdCount": 2,
				"VpcId": {"Fn::ImportValue": "us-east-1-synapse-${stack}-vpc-2-VPCId"}
			}
		}
	#end
	},
	"Outputs": {
		
	}
}